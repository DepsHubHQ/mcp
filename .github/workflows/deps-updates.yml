name: deps-updates

on:
  workflow_dispatch:

jobs:
  deps-updates:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v5

      - name: Authenticate gh
        run: |
          echo "fail" | gh auth login --with-token

      - name: Install DepsHub CLI MCP
        id: mcp
        uses: DepsHubHQ/github-action@v1

      - uses: openai/codex-action@v1
        with:
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}
          safety-strategy: unsafe
          prompt-file: ${{ steps.mcp.outputs.codex_prompt }}
          codex-args: ${{ steps.mcp.outputs.codex_args }}
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
